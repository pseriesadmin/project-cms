// ê°œì„ ëœ restoreFromCloud í•¨ìˆ˜
const restoreFromCloud = useCallback(async (): Promise<T | null> => {
  try {
    if (!backupState.isOnline) {
      throw new Error('ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤.');
    }

    const apiEndpoint = dataType === 'project' 
      ? `/api/project?userId=${userId}`
      : `/api/backup`;

    const response = await fetch(apiEndpoint);
    
    // ì‘ë‹µ ìƒíƒœì— ë”°ë¥¸ ì„¸ë¶„í™”ëœ ì²˜ë¦¬
    if (!response.ok) {
      if (response.status === 404) {
        console.log(`ğŸ“ [restoreFromCloud] ì €ì¥ëœ ${dataType} ë°ì´í„° ì—†ìŒ (404)`);
        return null; // 404ëŠ” ì •ìƒì ì¸ ìƒí™©ìœ¼ë¡œ ì²˜ë¦¬
      }
      throw new Error(`ë³µì› ì‹¤íŒ¨: ${response.status} ${response.statusText}`);
    }

    const result = await response.json();
    
    // API ì‘ë‹µ êµ¬ì¡° ê°œì„ ì— ë”°ë¥¸ ì²˜ë¦¬
    if (!result.success) {
      if (result.isEmpty) {
        console.log(`ğŸ“ [restoreFromCloud] ${dataType} ë°ì´í„° ì—†ìŒ - ì´ˆê¸° ìƒíƒœ`);
        return null; // ë¹ˆ ë°ì´í„°ëŠ” ì •ìƒ ìƒí™©
      }
      throw new Error(result.error || 'ë³µì› ì²˜ë¦¬ ì‹¤íŒ¨');
    }

    console.log(`âœ… í´ë¼ìš°ë“œ ë³µì› ì„±ê³µ (${dataType})`);
    
    return dataType === 'project' ? result.projectData : result.data;
    
  } catch (error) {
    // ì˜¤ë¥˜ ìœ í˜•ë³„ ë¡œê¹… ê°œì„ 
    if (error instanceof TypeError && error.message.includes('fetch')) {
      console.warn(`ğŸŒ [restoreFromCloud] ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ - ${dataType} ë³µì› ì‹¤íŒ¨`);
    } else if (error.message.includes('404')) {
      console.log(`ğŸ“ [restoreFromCloud] ${dataType} ë°ì´í„° ì—†ìŒ`);
    } else {
      console.error(`âŒ í´ë¼ìš°ë“œ ë³µì› ì‹¤íŒ¨ (${dataType}):`, error);
    }
    
    // 404ë‚˜ ë¹ˆ ë°ì´í„°ì˜ ê²½ìš° null ë°˜í™˜, ê·¸ ì™¸ëŠ” ì—ëŸ¬ throw
    if (error.message.includes('404') || error.message.includes('ë°ì´í„° ì—†ìŒ')) {
      return null;
    }
    throw error;
  }
}, [dataType, userId, backupState.isOnline]);
